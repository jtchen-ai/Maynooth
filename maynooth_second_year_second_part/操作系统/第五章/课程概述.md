# 第五章



## 课程概述

- **主要内容：**
  - 多处理器系统调度及性能问题
  - 排队理论在系统建模中的应用
  - 多处理器系统的队列组织设计
  - 分布式调度与实时系统调度
- **学习目标：**
  - 掌握多处理器与分布式系统下调度问题的核心考点
  - 了解排队模型、到达过程及服务系统如何影响性能
  - 考研408拓展：数学模型推导、性能分析与优化设计

## 多处理器调度与性能问题

- **核心考点：**
  - **多处理器调度问题：**  
    - 处理器数量增加不一定成正比提高性能，受共享资源（总线、I/O、缓存一致性等）影响  
    - 异构与同构处理器调度策略不同：  
      - 同构系统可采用单队列或对称、非对称多处理
  - **性能瓶颈：**  
    - 共享资源争用（内存、I/O带宽、总线冲突）
    - 操作系统代码与缓存一致性维持开销

- **解题技巧：**
  - 构建多处理器调度的系统模型，找出关键瓶颈（如锁争用、缓存失效）
  - 结合实际案例，定量分析处理器利用率与调度算法之间的关系

- **考研408拓展：**
  - 利用数学模型（如Little定律、Amdahl定律）进行理论推导
  - 考虑系统规模扩展时非线性性能衰减的分析

## 排队理论及建模

- **核心考点：**
  - **排队理论基础：**
    - 分析等待队列（任务到达、排队、服务）的数学模型
    - 到达率（λ）与服务率（μ）的关系：系统的负载必须满足 μ > λ
  - **常见分布：**
    - 任务到达：采用 Poisson 分布来描述随机到达
    - 服务时间：常用指数分布（Exponential Distribution），其平均服务时间为 1/μ
  - **Little 定律：**
    - 平均转换时间 T 与系统中平均任务数 L、到达率 λ 的关系： T = L / λ

- **解题技巧：**
  - 利用统计数据拟合任务到达率与服务时间分布，建立概率模型
  - 配合仿真与模拟分析排队系统的平均等待时间及响应时间
  - 在题目中，通过公式计算系统响应时间、队列长度，从而评估调度策略

- **考研408拓展：**
  - 综合利用马尔可夫链方法对多阶段排队系统建模
  - 分析含有限队列空间、任务丢失效应（balking、reneging）的实时系统
  - 数学证明系统稳定性与服务质量（QoS）之间的关系

## 多处理器系统的队列组织

- **核心考点：**
  - **队列组织方法：**
    - 单队列模型：所有处理器共享一个统一任务队列（适用于同构处理器）
    - 多队列模型：各处理器拥有自己的队列，常见于分布式或物理约束明显场景（如超市票据）
    - “蛇形队列”（Serpentine Queue）：银行、票务系统常用，平衡等待时间与任务分配
  - **调度策略对性能影响：**
    - 队列组织直接影响任务调度、任务分布、系统负载均衡
    - 合理设计队列可以减少平均等待时间和上下文切换次数

- **解题技巧：**
  - 分析系统任务的空间和时间局部性，判断适合单队列还是多队列结构
  - 模型化任务分布与处理器利用率，求解最佳队列划分问题
  - 结合排队理论，计算不同组织方式下的平均响应时间

- **考研408拓展：**
  - 利用优化算法设计多级调度策略，如对任务动态分配权重
  - 分析“负载均衡问题”在异构多处理器系统中的数学最优化模型

## 分布式系统调度

- **核心考点：**
  - **分布式调度特点：**
    - 信息分散，每个节点有局部调度数据
    - 需要通过网络消息交换获取全局状态信息
    - 网络延迟、消息丢失及数据同步带来的额外调度复杂性
  - **主要调度策略：**
    - 静态分配：提前分配各节点任务
    - 动态调度：实时监控各节点负载，调整任务分布以实现负载均衡

- **解题技巧：**
  - 理解分布式调度中跨节点通信的延迟模型
  - 利用模拟及实验数据估计网络拥塞对调度性能的影响
  - 分析算法的鲁棒性与自适应性，对比静态与动态调度的性能差异

- **考研408拓展：**
  - 设计分布式调度的数学模型，证明其收敛性与最优性
  - 分析分布式系统在大规模集群下的调度策略演化

## 实时系统调度

- **核心考点：**
  - **实时系统特点：**
    - 必须满足严格的时间限制，任务延误可能导致系统失效
    - 分为硬实时系统（严格限时）和软实时系统（偶尔延迟可容忍）
  - **调度算法：**
    - Earliest Deadline First (EDF)：根据截止时间排序调度任务
    - Least Laxity First (LLF)：选择松弛时间最短的任务优先执行
  - **调度要求：**
    - 低派发延迟：系统调用需支持抢占，保证高优先级任务快速响应
  
- **解题技巧：**
  - 分析任务的周期性与截止时间，推导各任务的松弛量
  - 模拟比较 EDF 与 LLF 的调度效果，计算系统中任务的截止违约率
  - 从理论上证明在给定负载与任务集合下系统调度的可行性（利用响应时间分析）

- **考研408拓展：**
  - 证明实时调度算法在系统负载达到特定阈值时的稳定性问题
  - 基于数学模型推导调度窗口及任务优先级的动态调整机制

## 综合案例与调度优化

- **综合案例：**
  - 给出一组多任务、混合到达的案例：
    - 分析在多处理器系统中，各种队列组织、调度策略对总体系统响应时间与吞吐量的影响
  - 讨论如何设计合理的分布式任务调度策略，平衡网络延迟与负载均衡
  - 实时系统中如何利用 EDF 或 LLF 完成任务调度，同时保证高优先级任务响应

- **解题技巧：**
  - 模块化分析：将问题拆分为任务到达、排队等待、服务处理三个模块分别求解再综合运用
  - 参数敏感性分析：针对不同到达率、服务率、网络延迟等参数建立数学模型
  - 利用仿真与数值分析验证不同调度策略下系统性能的实际表现

- **考研408拓展：**
  - 从数学上证明最优调度策略的存在性
  - 探讨不同系统（多处理器、分布式、实时）的混合调度算法与动态优化方案

## 总结与答疑

- **核心要点回顾：**
  - 多处理器调度不仅仅增设处理器，还要处理共享资源争用、缓存一致性等问题
  - 排队理论为调度系统建模提供了重要工具，掌握 Poisson 分布与指数服务时间建模方法
  - 分布式系统和实时系统调度各具特点，需结合网络延时、任务截止时间进行深入设计
- **解题策略总结：**
  - 建立系统的数学模型，明确各关键参数（λ、μ、处理器数、权重等）
  - 分区域、分模块分析各种调度策略优缺点，利用实验数据验证理论推导
- **讨论与答疑：**
  - 各位同学对多处理器系统中调度瓶颈和调度算法如何适应不同场景有什么疑问？
  - 实际案例中的参数选取及模型假设是否具备普适性讨论

## 参考资料与拓展阅读

- **核心书籍：**
  - 《操作系统概念》、 《现代操作系统》
  - 分布式系统与实时调度相关论文与专著
- **考研408相关习题与高难度案例解析**
- **最新研究方向：**
  - 多核、异构/虚拟化系统下调度算法的发展趋势
  - 利用大数据与机器学习优化调度决策
